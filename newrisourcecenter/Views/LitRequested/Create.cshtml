@model newrisourcecenter.Models.LitRequestedViewModel

@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script>
    $(document).ready(function () {

        getLitData = function (data) {
            var id = data.split("|")[0];
            var lit = data.split("|")[1];
            var quantity = $("."+id).val();
            $("#lit_" + id).val(lit+"|"+quantity);
        }

        $("#form").submit(function (e) {
            e.preventDefault;

            if ($("input[name='rlit_info']:checked").length == 0) {

                alert("Select literature and quantity");

                return false;
            }

            return true;
        });
    });
</script>
<div class="main_content">
    <span style = "float:right;margin:2px 10px 5px 0px;width:25px;height:25px;" id="countResults" >@ViewBag.countlits</span>
@Html.ActionLink("My Requested Literature", "Index", new { n1_name= "My Requested Literature" }, htmlAttributes: new { @class = "btn btn-primary", @style = "float:right;margin:10px;" })
    <p>
        <br /><br />
    </p>
@using (Html.BeginForm("Create", "LitRequested", FormMethod.Post, new { enctype = "multipart/form-data", @id="form" }))
{
    @Html.AntiForgeryToken()
    <div class="form-horizontal">
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <input type="hidden" name="rlit_ID" id="rlit_ID" value="1" />
        <table style="width:95%;margin-left:auto;margin-right:auto;position:relative;">
            <tr>
                <th colspan="2">Literature Name</th>
                <th style="width:40px;"></th>
                <th colspan="1" >Quantity</th>
                <th style="width:40px;"></th>
              <th>Preview Literature</th>
            </tr>
                @{
                    int x = 1;
                    foreach (var item in Model.lit_name)
                    {
                        string data = item.lit_name;
                        <tr id="tr">
                            <td colspan="2" style="padding:10px;"><input type="checkbox" name="rlit_info" id="lit_@x" value=""  />@item.lit_name</td>
                            <td style="width:40px;"></td>
                            <td colspan="1" style="padding:10px;"><input type="text" id="@x|@item.lit_name" class="@x form-control" onkeyup="getLitData(this.id);" value="" style="width:20%;" /></td>
                            <td style="width:40px;"></td>
                            <td style="padding:10px;">
                                @item.risource
                                   @foreach (var items in item.list_attachments)
                                   {
                                       Uri uriResult;
                                       bool result = Uri.TryCreate(items.img, UriKind.Absolute, out uriResult)
                                       && (uriResult.Scheme == Uri.UriSchemeHttp
                                       || uriResult.Scheme == Uri.UriSchemeHttps);

                                       if (result)
                                       {
                                        <div>
                                            <div style="float:left;">@items.name</div>
                                            <div style="float:right;">
                                                <a id="@ViewBag.file_size" target="_blank" href="@items.img" class="btn btn-primary btn-sm glyphicon glyphicon-new-window" style="float:right;"> Link</a>
                                            </div>
                                            <br clear="all" />
                                            <br clear="all" />
                                        </div>
                                        }
                                        else
                                        {
                                            <div>
                                                <div style="float:left;">@items.name</div>
                                                <div style="float:right;">
                                                    <a id="@ViewBag.file_size" href="~/attachments/risources/@items.img" class="btn btn-primary btn-sm glyphicon glyphicon-download-alt" > Download</a>
                                                </div>
                                                <br clear="all" />
                                                <br clear="all" />
                                            </div>
                                        }
                                    }
                            </td>
                        </tr>
                        <tr><td><br /></td></tr>
                        x++;
                    }
               }
        </table>

        <div class="form-group">
            <div class="col-md-10">
                @Html.HiddenFor(model => model.status, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.status, "", new { @class = "text-danger" })
            </div>
        </div>

        <input name="date_created" id="date_created" type="hidden" value=@DateTime.Now />
        <input name="usr_ID" id="usr_ID" type="hidden" value=@Session["userId"] />

        <div class="form-group">
            <div class="col-md-offset-1">
                <input type="submit" value="Submit Request" class="btn btn-default" />
            </div>
        </div>
    </div>
}

</div>
