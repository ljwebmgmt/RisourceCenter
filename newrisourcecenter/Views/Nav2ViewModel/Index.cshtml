@model IEnumerable<newrisourcecenter.Models.Nav2ViewModel>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script type="text/javascript">
    $(document).on('click', '.ajax-filter', function (e) {
        e.preventDefault();
        var url = $(this).attr('href');
        $(this).closest('.dropdown ').removeClass('open');
        $.ajax({
            url: url,
            type: 'GET',
            beforeSend: function () {
                $('table.table').css('opacity', '0.5');
            },
            success: function (result) {
                $('table.table tbody#tbody').html(result);
                window.history.pushState({ path: url }, '', url);
                $('table.table').css('opacity', '1');

            },
            error: function () {
                alert("Error loading data. Please try again.");
                $('table.table').css('opacity', '1');
            }
        });
    });
</script>
<div>
    <div class="dropdown" style="display:inline-block;">
        <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">
            @Model.LastOrDefault().nav2labels.FirstOrDefault().filter_link_label[0]
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li><a class="ajax-filter" href="?parentid=0&n1_name=@Request.QueryString["n1_name"]&msg=@ViewBag.n1_name">@ViewBag.n1_name</a></li>
            @foreach (var item in @ViewBag.list_n1ID)
            {
                <li><a class="ajax-filter" href="?parentid=@item.id&msg=@item.name&n1_name=@Request.QueryString["n1_name"]">@item.name</a></li>
            }
        </ul>
    </div>

    <div class="dropdown" style="display:inline-block;">
        <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">
            @Model.LastOrDefault().nav2labels.FirstOrDefault().add_link_label[0]
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li><a href="~/Nav2ViewModel/Create?parentid=0&n1_name=@Request.QueryString["n1_name"]&msg=@ViewBag.n1_name">@ViewBag.n1_name</a></li>
            @foreach (var item in @ViewBag.list_n1ID)
            {
                <li><a href="~/Nav2ViewModel/Create?parentid=@item.id&n1_name=@Request.QueryString["n1_name"]&msg=@item.name">@item.name</a></li>
            }
        </ul>
    </div>

</div>
<br />

<table class="table">
    <thead>
        <tr>
            <th>
                @Model.LastOrDefault().nav2labels.FirstOrDefault().n2order_label[0]
                @if (Request.QueryString["translate"] != null)
                {
                    @Html.ActionLink("T", "Create", "Labels", new { labelName = @Model.LastOrDefault().nav2labels.FirstOrDefault().n2order_label[1], controllerName = "Nav2ViewModel", pageName = "Index", n1_name = "Translate Page Labels", msg = Request.QueryString["n1_name"] }, htmlAttributes: new { @id = "translate", @class = "glyphicon glyphicon-edit" })
                }
            </th>
            <th>
                @Model.LastOrDefault().nav2labels.FirstOrDefault().n2_nameLong_label[0]
                @if (Request.QueryString["translate"] != null)
                {
                    @Html.ActionLink("T", "Create", "Labels", new { labelName = @Model.LastOrDefault().nav2labels.FirstOrDefault().n2_nameLong_label[1], controllerName = "Nav2ViewModel", pageName = "Index", n1_name = "Translate Page Labels", msg = Request.QueryString["n1_name"] }, htmlAttributes: new { @id = "translate", @class = "glyphicon glyphicon-edit" })
                }
            </th>
            <th>
                @Model.LastOrDefault().nav2labels.FirstOrDefault().n2_descLong_label[0]
                @if (Request.QueryString["translate"] != null)
                {
                    @Html.ActionLink("T", "Create", "Labels", new { labelName = @Model.LastOrDefault().nav2labels.FirstOrDefault().n2_descLong_label[1], controllerName = "Nav2ViewModel", pageName = "Index", n1_name = "Translate Page Labels", msg = Request.QueryString["n1_name"] }, htmlAttributes: new { @id = "translate", @class = "glyphicon glyphicon-edit" })
                }
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody id="tbody">
        @Html.Partial("_Nav2Table",Model)
    </tbody>
</table>
