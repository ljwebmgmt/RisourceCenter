@model newrisourcecenter.Models.LiteratureViewModel

@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script>
    $(document).ready(function () {

        risourceSelection = function (selectedObject) {
            var selectedval = selectedObject.options[selectedObject.selectedIndex].value;
            var selectedid = selectedObject.options[selectedObject.selectedIndex].id;
            var link = "../../SalesComm/GetRiSources/?risource_id=" + selectedval + "&scID=" + selectedid;

            $.post(link, function (data) {
                $('div#risources').html("<br />" + data + "<br /><br />");
            });
        }

        $("form").submit(function (e) {
            e.preventDefault;

            if ($("#lit_name").val() == "") {

                alert("Enter a literature name");

                return false;
            }

            return true;
        });
    });
</script>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    
    <div class="lit_forms">
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.lit_ID)

        <div class="form-group">
            @Html.LabelFor(model => model.lit_name, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.lit_name, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.lit_name, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.risource_menu, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <select name="n2ID" onchange="risourceSelection(this);" class="form-control text-box single-line">
                    @foreach (var items in @ViewBag.RiSourceMenu)
                    {
                        <option value="@items.id">@items.name</option>
                    }
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2" for="risource_menu"></label>
            <div class="col-md-10">
                <div id="risources">

                </div>
                <div id="risourceSelected">
                    @foreach (var items in Model.list_attachments)
                {
                    Uri uriResult;
                    bool result = Uri.TryCreate(items.img, UriKind.Absolute, out uriResult)
                    && (uriResult.Scheme == Uri.UriSchemeHttp
                    || uriResult.Scheme == Uri.UriSchemeHttps);

                    if (result)
                    {
                            <div id="@items.id">
                                <input type="checkbox" name="attach_risource" id="@items.id" value="@items.id" checked />@items.name
                                <a id="@ViewBag.file_size" target="_blank" href="@items.img" class="btn btn-primary btn-sm glyphicon glyphicon-new-window"> Link</a>
                            </div>
                        }
                        else
                        {
                            <div id="@items.id">
                                <input type="checkbox" name="attach_risource" id="@items.id" value="@items.id" checked />@items.name
                                <a id="@ViewBag.file_size" href="~/attachments/risources/@items.img" class="btn btn-primary btn-sm glyphicon glyphicon-download-alt"> Download</a>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-10">
                @Html.HiddenFor(model => model.created_by, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.created_by, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-10">
                @Html.HiddenFor(model => model.date_created, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.date_created, "", new { @class = "text-danger" })
            </div>
        </div>

        <input name="date_updated" id="date_updated" type="hidden" value=@DateTime.Now />
        <input name="updated_by" id="updated_by" type="hidden" value=@Session["userId"] />

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Save" class="btn btn-default" />
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Back to List", "Create", new { n1_name = "Manage Literature" })
</div>
