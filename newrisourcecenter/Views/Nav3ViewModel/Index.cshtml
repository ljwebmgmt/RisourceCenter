@model IEnumerable<newrisourcecenter.Models.Nav3ViewModel>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script type="text/javascript">
    $(document).on('click', '.ajax-filter', function (e) {
        e.preventDefault();
        var url = $(this).attr('href');
        $(this).closest('.dropdown').removeClass('open');
        $.ajax({
            url: url,
            type: 'GET',
            beforeSend: function () {
                $('table.table').css('opacity', '0.5');
            },
            success: function (result) {
                $('table.table tbody#tbody').html(result);
                window.history.pushState({ path: url }, '', url);
                $('table.table').css('opacity', '1');

            },
            error: function () {
                alert("Error loading data. Please try again.");
                $('table.table').css('opacity', '1');
            }
        });
    });
</script>
<table>
    <tr>
        <td>
            <div class="dropdown">
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">
                    @Model.LastOrDefault().nav3labels.FirstOrDefault().filter_link_label[0]
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    @foreach (var item in @ViewBag.list_n1ID)
                    {
                        <li><a class="ajax-filter" href="?parentid=@item.id&n2Id=@item.n2id&n1_name=@Request.QueryString["n1_name"]&n2_name=@item.name&rarr;@item.n2name">@item.name - @item.n2name</a></li>
                    }
                </ul>
            </div>
        </td>
        <td>
            <div class="dropdown">
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">
                    @Model.LastOrDefault().nav3labels.FirstOrDefault().add_link_label[0]
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    @foreach (var item in @ViewBag.list_n1ID)
                    {
                        <li><a href="~/Nav3ViewModel/Create?n1id=@item.id&n2Id=@item.n2id&n1_name=@Request.QueryString["n1_name"]&n2_name=@item.name&rarr;@item.n2name">@item.name - @item.n2name</a></li>
                    }
                </ul>
            </div>
        </td>
    </tr>    
</table>
<br />
@if (@Model!=null){
<table class="table">
    <thead>
        <tr>
            <th>
                @Model.LastOrDefault().nav3labels.FirstOrDefault().n3order_label[0]
                @if (Request.QueryString["translate"] != null)
                {
                    @Html.ActionLink("T", "Create", "Labels", new { labelName = @Model.LastOrDefault().nav3labels.FirstOrDefault().n3order_label[1], controllerName = "Nav3ViewModel", pageName = "Index", n1_name = "Translate Page Labels", msg = Request.QueryString["n1_name"] }, htmlAttributes: new { @id = "translate", @class = "glyphicon glyphicon-edit" })
                }
            </th>
            <th>
                @Model.LastOrDefault().nav3labels.FirstOrDefault().n3_nameLong_label[0]
                @if (Request.QueryString["translate"] != null)
                {
                    @Html.ActionLink("T", "Create", "Labels", new { labelName = @Model.LastOrDefault().nav3labels.FirstOrDefault().n3_nameLong_label[1], controllerName = "Nav3ViewModel", pageName = "Index", n1_name = "Translate Page Labels", msg = Request.QueryString["n1_name"] }, htmlAttributes: new { @id = "translate", @class = "glyphicon glyphicon-edit" })
                }
            </th>
            <th>
                @Model.LastOrDefault().nav3labels.FirstOrDefault().n3_descLong_label[0]
                @if (Request.QueryString["translate"] != null)
                {
                    @Html.ActionLink("T", "Create", "Labels", new { labelName = @Model.LastOrDefault().nav3labels.FirstOrDefault().n3_descLong_label[1], controllerName = "Nav3ViewModel", pageName = "Index", n1_name = "Translate Page Labels", msg = Request.QueryString["n1_name"] }, htmlAttributes: new { @id = "translate", @class = "glyphicon glyphicon-edit" })
                }
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody id="tbody">
        @Html.Partial("_Nav3Table",Model)
    </tbody>
</table>
}